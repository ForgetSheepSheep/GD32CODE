/******************************************************************************
 * @file    drv_hum.h
 * @brief   湿度传感器驱动模块（ADC 采样 + 查表法）
 *
 * @note
 *  - 使用 ADC 采集湿度传感器（HS1101）电压值
 *  - 通过 ADC 值在二维表中匹配得到对应湿度
 *  - 湿度数据需要结合温度进行温度补偿
 *
 * 硬件说明：
 *  - 湿度传感器接 ADC 通道 PC4 / ADC_CHANNEL_14
 *  - 交流电源驱动：PB0/PB1 产生方波
 *  - ADC 参考电压为 MCU Vref
 *
 * 软件说明：
 *  - 使用定时器产生 2ms 交流驱动
 *  - 在定时器中断中采集 ADC 值
 *  - 查表法计算湿度，需输入当前温度值
 ******************************************************************************/

#ifndef __DRV_HUM_H
#define __DRV_HUM_H
#include "config.h"

/**
***********************************************************
* @brief  湿度传感器驱动初始化
* @param
* @return
* @note
*  该函数完成以下初始化：
*   1) GPIO 初始化（PB0/PB1 交流驱动输出，PC4 ADC 输入）
*   2) ADC 初始化（ADC1 通道14，单次转换模式）
*   3) 定时器初始化（TIMER4，2ms 周期，产生交流驱动）
*
*  调用示例：
*   HumiDrvInit();  // 初始化后自动开始采集
***********************************************************
*/
void HumiDrvInit(void);

/**
***********************************************************
* @brief  湿度传感器数据处理
* @param  temp: 当前温度值（单位：℃）
* @return
* @note
*  该函数在主循环中调用，用于更新湿度数据：
*   1) 根据温度值选择对应的查表行
*   2) 将 ADC 值转换为湿度值
*   3) 更新全局湿度变量
*
*  调用示例：
*   drv_Humi_Sensor_Proc((uint8_t)drv_get_temp());  // 传入温度进行补偿
***********************************************************
*/
void drv_Humi_Sensor_Proc(uint8_t temp);

/**
***********************************************************
* @brief  获取当前湿度值
* @param
* @return  湿度值（单位：%RH）
* @note
*  返回值范围：0.0 ~ 100.0
*  使用前需要先调用 drv_Humi_Sensor_Proc() 更新数据
*
*  调用示例：
*   float humi = drv_get_humiData();
***********************************************************
*/
float drv_get_humiData(void);

#endif /* __DRV_HUM_H */
